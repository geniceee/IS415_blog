---
title: "Take-home Exercise 1"
description: |
  A short description of the post.
author:
  - name: Genice Goh
    url: {}
date: 09-10-2021
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## 1.0 Introduction
This take-home exercise aims to reveal the spatial-temporal patterns of monthly cumulative confirmed COVID-19 rates and death rates in Jakarta DKI at the sub-district level.

## 2.0 The Data
For this assignment, the following data is used:

- Daily COVID-19 data at both sub-district and distict level. It is extracted from [Open Data Covid-19 Provinsi DKI Jakarta](https://riwayat-file-covid-19-dki-jakarta-jakartagis.hub.arcgis.com/).
- Geospatial data of Jakarta DKI in the form of a Shapefile (SHP). It is extracted from [PODES 2019](https://www.indonesia-geospasial.com/2020/04/download-shapefile-shp-batas-desa.html).

## 3.0 Instaling and Loading Packages

In this take-home exercise, the packages sf, tidyverse, tmap and readxl are used. 

```{r echo=TRUE, eval=TRUE}
packages = c('sf', 'tidyverse', 'tmap', 'readxl')
for (p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p,character.only = T)
}
```

## 4.0 Data Preparation and Wrangling
### 4.1 Geospatial Data

The geospatial data is imported with the use of *st_read()*.

```{r echo=TRUE, eval=TRUE}
DKI <- st_read(dsn="data/geospatial",
               layer="BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA")

glimpse(DKI)
```

### 4.1.1 Checking for NA values

Since the value TRUE is returned, it implies that the dataset contains NA values.

```{r echo=TRUE, eval=TRUE}
sum(is.na(DKI)) > 0
```

The function *drop_na* is used to drop the NA values in the dataset.

```{r echo=TRUE, eval=TRUE}
DKI <- drop_na(DKI)
```

### 4.1.2 CRS Check and Reprojection

The *st_crs()* function is used to check the coordinate reference system of the dataset.

```{r echo=TRUE, eval=TRUE}
st_crs(DKI)
```

Since the dataset is in WGS84 projection system, there is a need to transform it to the national projected coordinates system of Indonesia (DGN95/Indonesia TM-3 zone 54.1), which has an EPSG code of 23845.

```{r echo=TRUE, eval=TRUE}
DKI23845 <- st_transform(DKI, crs = 23845)
st_crs(DKI23845)
```

### 4.1.3 Exclude all outer islands

The *tmap()* function is used to plot the geospatial data for easy visualisation.

```{r echo=TRUE, eval=TRUE}
tmap_mode("view")
tm_shape(DKI23845) + 
  tm_polygons()
```

While looking at the data points of the outer islands using the interactive map, it can be observed that they share the same value "KEPULAUAN SERIBU" for the field "KAB_KOTA". This information can therefore be used to exclude the outer islands from the dataframe.

```{r echo=TRUE, eval=TRUE}
tmap_mode('plot')

DKI23845 <- DKI23845 %>% 
  filter(`KAB_KOTA` != "KEPULAUAN SERIBU")

plot(DKI23845)
```

### 4.1.4 Select the first 9 fields
```{r echo=TRUE, eval=TRUE}
DKI23845 <- DKI23845 %>% select(0:9)

DKI23845
```




